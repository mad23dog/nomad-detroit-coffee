<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>Nomad Detroit Coffee - Premium Single-Origin Coffee | Royal Oak Farmers Market</title>
    <meta name="description" content="Premium single-origin coffee roasted in small batches. Ethiopian, Guatemalan, Nicaraguan, and specialty blends. Visit us at Royal Oak Farmers Market every Saturday 7AM-1PM.">
    <meta name="keywords" content="coffee, single-origin coffee, specialty coffee, Detroit coffee, Royal Oak, farmers market, Ethiopian coffee, Guatemalan coffee, small batch roasted">
    <meta name="author" content="Nomad Detroit Coffee">
    <link rel="canonical" href="https://nomad-detroit-coffee.vercel.app/">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://nomad-detroit-coffee.vercel.app/">
    <meta property="og:title" content="Nomad Detroit Coffee - Premium Single-Origin Coffee">
    <meta property="og:description" content="Wander the world through coffee. Premium single-origin beans roasted in small batches. Find us at Royal Oak Farmers Market every Saturday.">
    <meta property="og:image" content="https://nomad-detroit-coffee.vercel.app/Images/Logos/coffee farm with N logo.png">
    <meta property="og:site_name" content="Nomad Detroit Coffee">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://nomad-detroit-coffee.vercel.app/">
    <meta property="twitter:title" content="Nomad Detroit Coffee - Premium Single-Origin Coffee">
    <meta property="twitter:description" content="Wander the world through coffee. Premium single-origin beans roasted in small batches.">
    <meta property="twitter:image" content="https://nomad-detroit-coffee.vercel.app/Images/Logos/coffee farm with N logo.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="Images/Logos/NOMAD Mountains Color 72ppi.png">
    <link rel="apple-touch-icon" href="Images/Logos/NOMAD Mountains Color 72ppi.png">
    
    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://www.paypal.com">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- PayPal SDK -->
    <script src="https://www.paypal.com/sdk/js?client-id=AVrx79RIjIfmKrGfdZEZ88yECTpW_2r2NxCeiUvv62PC_5foBnUX8B8mf9gfg57rgahUcUC5s420MhFk&currency=USD"></script>
    
    <!-- Local Business Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@graph": [
            {
                "@type": "Organization",
                "@id": "https://nomad-detroit-coffee.vercel.app/#organization",
                "name": "Nomad Detroit Coffee",
                "url": "https://nomad-detroit-coffee.vercel.app/",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://nomad-detroit-coffee.vercel.app/Images/Logos/NOMAD Full Logo Color 72ppi.png"
                },
                "contactPoint": {
                    "@type": "ContactPoint",
                    "telephone": "+1-586-873-7910",
                    "contactType": "customer service",
                    "email": "hello@nomaddetroitcoffee.com"
                },
                "sameAs": []
            },
            {
                "@type": "LocalBusiness",
                "@id": "https://nomad-detroit-coffee.vercel.app/#localbusiness",
                "name": "Nomad Detroit Coffee",
                "description": "Premium single-origin coffee roasted in small batches. Specializing in Ethiopian, Guatemalan, and Nicaraguan coffee beans.",
                "url": "https://nomad-detroit-coffee.vercel.app/",
                "telephone": "+1-586-873-7910",
                "email": "hello@nomaddetroitcoffee.com",
                "address": {
                    "@type": "PostalAddress",
                    "streetAddress": "316 E 11 Mile Rd",
                    "addressLocality": "Royal Oak",
                    "addressRegion": "MI",
                    "postalCode": "48067",
                    "addressCountry": "US"
                },
                "geo": {
                    "@type": "GeoCoordinates",
                    "latitude": 42.4894442,
                    "longitude": -83.1456284
                },
                "openingHoursSpecification": {
                    "@type": "OpeningHoursSpecification",
                    "dayOfWeek": "Saturday",
                    "opens": "07:00",
                    "closes": "13:00"
                },
                "priceRange": "$22",
                "servesCuisine": "Coffee",
                "paymentAccepted": ["Cash", "Credit Card", "PayPal"],
                "currenciesAccepted": "USD"
            }
        ]
    }
    </script>
</head>
<body>
    <div class="background-container">
        <div class="floating-element element-1"></div>
        <div class="floating-element element-2"></div>
        <div class="floating-element element-3"></div>
    </div>

    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <a href="#" onclick="smoothScrollTo('home'); return false;">
                    <img src="Images/Logos/NOMAD Mountains Color 72ppi.png" alt="Nomad Detroit Coffee" class="logo-img">
                </a>
            </div>
            <ul class="nav-menu" id="nav-menu">
                <li><a href="#" onclick="smoothScrollTo('home'); closeMenu(); return false;">Home</a></li>
                <li><a href="#" onclick="smoothScrollTo('about'); closeMenu(); return false;">About</a></li>
                <li><a href="#" onclick="smoothScrollTo('coffee'); closeMenu(); return false;">Coffee</a></li>
                <li><a href="#" onclick="smoothScrollTo('contact'); closeMenu(); return false;">Visit Us</a></li>
                <li><a href="#" id="cart-toggle">Cart <span id="cart-count">0</span></a></li>
            </ul>
            <div class="hamburger" id="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <!-- Shopping Cart Sidebar -->
    <div id="cart-sidebar" class="cart-sidebar">
        <div class="cart-content glass-card">
            <div class="cart-header">
                <h3>Your Cart</h3>
                <button id="close-cart">&times;</button>
            </div>
            <div id="cart-items" class="cart-items">
                <p class="empty-cart">Your cart is empty</p>
            </div>
            <div class="cart-footer">
                <div class="cart-total" style="display: none;">
                    <div class="cart-subtotal">Subtotal: $<span id="cart-subtotal">0.00</span></div>
                    <div class="cart-shipping" style="display: none;">Shipping: $<span id="cart-shipping">0.00</span></div>
                    <div class="cart-final-total"><strong>Total: $<span id="cart-total">0.00</span></strong></div>
                </div>
                <div id="paypal-checkout-container"></div>
            </div>
        </div>
    </div>

    <main>
        <section id="home" class="hero">
            <div class="hero-content">
                <div class="glass-card hero-card">
                    <div class="hero-text">
                        <h1>Nomad Detroit Coffee</h1>
                        <p>Wander the World Through Coffee</p>
                        <button class="cta-button" onclick="smoothScrollTo('coffee')">Explore Our Coffees</button>
                    </div>
                    <div class="hero-image">
                        <img src="Images/Logos/coffee farm with N logo.png" alt="Nomad Detroit Coffee Logo - Coffee Farm with N" class="hero-logo">
                    </div>
                </div>
            </div>
        </section>

        <section id="about" class="about">
            <div class="container">
                <article class="glass-card">
                    <h2>Our Story</h2>
                    <p>We founded <strong>Nomad Detroit Coffee</strong> in 2018 rooted in our shared love and curiosity of coffee and the journey it takes from earth to cup. Blending together craft and data we artistically roast in <em>small batches</em> ensuring a perfect brewed cup aimed to transport you to the corner of the world from which it originates. Specializing in <strong>single-origin coffee</strong> from <em>Ethiopia</em>, <em>Guatemala</em>, and <em>Nicaragua</em>, we bring you the finest beans roasted to perfection. Visit us at the <strong>Royal Oak Farmers Market</strong> every Saturday morning.</p>
                </article>
            </div>
        </section>

        <section id="coffee" class="coffee-section">
            <div class="container">
                <h2>Our Coffee</h2>
                <div class="coffee-grid">
                    <article class="glass-card coffee-card" itemscope itemtype="https://schema.org/Product">
                        <img src="Images/Bag Info Labels/Ethiopia.png" alt="Ethiopia Single-Origin Coffee Bag - Premium Ethiopian Coffee from Wush Wush Region" class="coffee-image" itemprop="image">
                        <h3 itemprop="name">Ethiopia Single-Origin Coffee</h3>
                        <p itemprop="description">Single-origin Ethiopian coffee with vibrant blueberry sweetness and bright lemon citrus notes, reminiscent of a fresh-baked pound cake. Natural processed beans from the Wush Wush region.</p>
                        <div class="price" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
                            <span itemprop="priceCurrency" content="USD">$</span><span itemprop="price" content="22">22</span> - 12 oz
                            <meta itemprop="availability" content="https://schema.org/InStock">
                        </div>
                        <button class="add-to-cart-btn" data-price="22" data-item="Ethiopia">Add to Cart</button>
                    </article>
                    <article class="glass-card coffee-card" itemscope itemtype="https://schema.org/Product">
                        <img src="Images/Bag Info Labels/Guatemala.png" alt="Guatemala Single-Origin Coffee Bag - Premium Guatemalan Coffee from Baja Verapaz" class="coffee-image" itemprop="image">
                        <h3 itemprop="name">Guatemala Single-Origin Coffee</h3>
                        <p itemprop="description">Rich Guatemalan single-origin from Baja Verapaz with indulgent macadamia nut richness and sweet cookie-like finish. Washed process brings out clean, balanced flavors.</p>
                        <div class="price" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
                            <span itemprop="priceCurrency" content="USD">$</span><span itemprop="price" content="22">22</span> - 12 oz
                            <meta itemprop="availability" content="https://schema.org/InStock">
                        </div>
                        <button class="add-to-cart-btn" data-price="22" data-item="Guatemala">Add to Cart</button>
                    </article>
                    <article class="glass-card coffee-card" itemscope itemtype="https://schema.org/Product">
                        <img src="Images/Bag Info Labels/Nicaragua.png" alt="Nicaragua Single-Origin Coffee Bag - Premium Nicaraguan Coffee from Matagalpa" class="coffee-image" itemprop="image">
                        <h3 itemprop="name">Nicaragua Single-Origin Coffee</h3>
                        <p itemprop="description">Nicaraguan single-origin from Matagalpa featuring warm brown sugar sweetness, bright cherry acidity, and satisfying nutty undertones. Expertly washed for clarity and balance.</p>
                        <div class="price" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
                            <span itemprop="priceCurrency" content="USD">$</span><span itemprop="price" content="22">22</span> - 12 oz
                            <meta itemprop="availability" content="https://schema.org/InStock">
                        </div>
                        <button class="add-to-cart-btn" data-price="22" data-item="Nicaragua">Add to Cart</button>
                    </article>
                    <article class="glass-card coffee-card" itemscope itemtype="https://schema.org/Product">
                        <img src="Images/Bag Info Labels/Vagabond.png" alt="Vagabond Coffee Blend - Premium Ethiopian and Nicaraguan Coffee Blend" class="coffee-image" itemprop="image">
                        <h3 itemprop="name">Vagabond Coffee Blend</h3>
                        <p itemprop="description">Premium blend combining Ethiopian and Nicaraguan beans. Complex flavor profile with juicy blueberry notes, zesty citrus brightness, and smooth almond finish. Washed and natural processing.</p>
                        <div class="price" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
                            <span itemprop="priceCurrency" content="USD">$</span><span itemprop="price" content="22">22</span> - 12 oz
                            <meta itemprop="availability" content="https://schema.org/InStock">
                        </div>
                        <button class="add-to-cart-btn" data-price="22" data-item="Vagabond">Add to Cart</button>
                    </article>
                    <article class="glass-card coffee-card" itemscope itemtype="https://schema.org/Product">
                        <img src="Images/Bag Info Labels/Decaf.png" alt="Decaf Colombian Coffee - Premium Decaffeinated Coffee from Valle de Cauca" class="coffee-image" itemprop="image">
                        <h3 itemprop="name">Decaf Colombian Coffee</h3>
                        <p itemprop="description">Colombian decaf from Valle de Cauca with warming clove spice, sweet cherry notes, and rich honeycomb sweetness. All the exceptional flavor without the caffeine.</p>
                        <div class="price" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
                            <span itemprop="priceCurrency" content="USD">$</span><span itemprop="price" content="22">22</span> - 12 oz
                            <meta itemprop="availability" content="https://schema.org/InStock">
                        </div>
                        <button class="add-to-cart-btn" data-price="22" data-item="Decaf">Add to Cart</button>
                    </article>
                </div>
            </div>
        </section>

        <section id="contact" class="contact">
            <div class="container">
                <div class="glass-card">
                    <h2>Visit Us</h2>
                    <p>Royal Oak Farmers Market<br>316 E 11 Mile Rd, Royal Oak, MI 48067</p>
                    <p>Saturdays: 7AM - 1PM</p>
                    <div class="map-container">
                        <iframe 
                            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2943.8537345156193!2d-83.1456284!3d42.4894442!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x8824c0c6b0f6c5c5%3A0x8b6c6c6c6c6c6c6c!2sRoyal%20Oak%20Farmers%20Market!5e0!3m2!1sen!2sus!4v1625000000000!5m2!1sen!2sus"
                            width="100%" 
                            height="250" 
                            style="border:0; border-radius: 10px;" 
                            allowfullscreen="" 
                            loading="lazy" 
                            referrerpolicy="no-referrer-when-downgrade">
                        </iframe>
                    </div>
                </div>
            </div>
        </section>

        <section class="quote-section">
            <div class="container">
                <div class="glass-card quote-card">
                    <blockquote class="featured-quote">
                        "Coffee in its variety of shapes, sizes, density, aroma, and flavor is a perfect representation of the diversity of the world we call home. To that end, we hope and encourage you to enjoy this coffee in whichever way you choose, pour over, drip, french press, espresso... cream, sugar, or black. However you like it is exactly the way we like it."
                    </blockquote>
                </div>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <p>Email: hello@nomaddetroitcoffee.com</p>
            <p>&copy; 2025 Nomad Detroit Coffee. All rights reserved.</p>
        </div>
    </footer>

    <script>
        let cart = [];
        let cartTotal = 0;
        const shippingCost = 5.00;

        function smoothScrollTo(elementId) {
            const element = document.getElementById(elementId);
            if (element) {
                // Calculate navbar height dynamically
                const navbar = document.querySelector('.navbar');
                const navbarHeight = navbar ? navbar.offsetHeight + 20 : 80; // Add 20px buffer
                const elementPosition = element.offsetTop - navbarHeight;
                
                window.scrollTo({
                    top: Math.max(0, elementPosition), // Ensure we don't scroll to negative position
                    behavior: 'smooth'
                });
            }
        }

        function toggleMenu() {
            const navMenu = document.getElementById('nav-menu');
            const hamburger = document.getElementById('hamburger');
            navMenu.classList.toggle('active');
            hamburger.classList.toggle('active');
        }

        function closeMenu() {
            const navMenu = document.getElementById('nav-menu');
            const hamburger = document.getElementById('hamburger');
            navMenu.classList.remove('active');
            hamburger.classList.remove('active');
        }

        document.addEventListener('DOMContentLoaded', function() {
            const cartToggle = document.getElementById('cart-toggle');
            const cartSidebar = document.getElementById('cart-sidebar');
            const closeCart = document.getElementById('close-cart');
            const addToCartButtons = document.querySelectorAll('.add-to-cart-btn');
            const hamburger = document.getElementById('hamburger');
            const navMenu = document.getElementById('nav-menu');

            // Hamburger menu functionality
            hamburger.addEventListener('click', toggleMenu);

            // Close menu when clicking on nav links or outside
            navMenu.addEventListener('click', function(e) {
                if (e.target.tagName === 'A' && e.target.id !== 'cart-toggle') {
                    closeMenu();
                }
            });

            // Cart toggle functionality
            cartToggle.addEventListener('click', function(e) {
                e.preventDefault();
                cartSidebar.classList.add('active');
                closeMenu(); // Close mobile menu when opening cart
            });

            closeCart.addEventListener('click', function() {
                cartSidebar.classList.remove('active');
            });

            // Close cart when clicking outside
            cartSidebar.addEventListener('click', function(e) {
                if (e.target === cartSidebar) {
                    cartSidebar.classList.remove('active');
                }
            });

            // Add to cart functionality
            addToCartButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const price = parseFloat(this.getAttribute('data-price'));
                    const item = this.getAttribute('data-item');
                    
                    addToCart(item, price);
                    updateCartDisplay();
                    
                    // Show success feedback
                    this.textContent = 'Added!';
                    setTimeout(() => {
                        this.textContent = 'Add to Cart';
                    }, 1000);
                });
            });

            // Initialize PayPal checkout button
            initPayPalCheckout();
        });

        function addToCart(item, price) {
            const existingItem = cart.find(cartItem => cartItem.name === item);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({ name: item, price: price, quantity: 1 });
            }
            
            updateCartTotal();
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartDisplay();
            updateCartTotal();
        }

        function updateQuantity(index, newQuantity) {
            if (newQuantity <= 0) {
                removeFromCart(index);
            } else {
                cart[index].quantity = newQuantity;
                updateCartDisplay();
                updateCartTotal();
            }
        }

        function updateCartTotal() {
            const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            cartTotal = subtotal + (cart.length > 0 ? shippingCost : 0);
            
            document.getElementById('cart-subtotal').textContent = subtotal.toFixed(2);
            document.getElementById('cart-shipping').textContent = cart.length > 0 ? shippingCost.toFixed(2) : '0.00';
            document.getElementById('cart-total').textContent = cartTotal.toFixed(2);
            
            // Show/hide entire cart total section based on cart contents
            const cartTotalElement = document.querySelector('.cart-total');
            const shippingElement = document.querySelector('.cart-shipping');
            
            if (cart.length > 0) {
                cartTotalElement.style.display = 'block';
                shippingElement.style.display = 'block';
            } else {
                cartTotalElement.style.display = 'none';
                shippingElement.style.display = 'none';
            }
        }

        function updateCartDisplay() {
            const cartItems = document.getElementById('cart-items');
            const cartCount = document.getElementById('cart-count');
            
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            cartCount.textContent = totalItems;

            // Clear existing content
            cartItems.innerHTML = '';

            if (cart.length === 0) {
                const emptyMessage = document.createElement('p');
                emptyMessage.className = 'empty-cart';
                emptyMessage.textContent = 'Your cart is empty';
                cartItems.appendChild(emptyMessage);
            } else {
                cart.forEach((item, index) => {
                    const cartItem = document.createElement('div');
                    cartItem.className = 'cart-item';
                    
                    const itemInfo = document.createElement('div');
                    itemInfo.className = 'cart-item-info';
                    
                    const itemName = document.createElement('h4');
                    itemName.textContent = item.name;
                    itemInfo.appendChild(itemName);
                    
                    const itemPrice = document.createElement('p');
                    itemPrice.textContent = `$${item.price.toFixed(2)} each`;
                    itemInfo.appendChild(itemPrice);
                    
                    const itemControls = document.createElement('div');
                    itemControls.className = 'cart-item-controls';
                    
                    const decreaseBtn = document.createElement('button');
                    decreaseBtn.className = 'qty-btn';
                    decreaseBtn.textContent = '-';
                    decreaseBtn.onclick = () => updateQuantity(index, item.quantity - 1);
                    itemControls.appendChild(decreaseBtn);
                    
                    const quantity = document.createElement('span');
                    quantity.className = 'quantity';
                    quantity.textContent = item.quantity;
                    itemControls.appendChild(quantity);
                    
                    const increaseBtn = document.createElement('button');
                    increaseBtn.className = 'qty-btn';
                    increaseBtn.textContent = '+';
                    increaseBtn.onclick = () => updateQuantity(index, item.quantity + 1);
                    itemControls.appendChild(increaseBtn);
                    
                    const removeBtn = document.createElement('button');
                    removeBtn.className = 'remove-btn';
                    removeBtn.textContent = 'Ã—';
                    removeBtn.onclick = () => removeFromCart(index);
                    itemControls.appendChild(removeBtn);
                    
                    cartItem.appendChild(itemInfo);
                    cartItem.appendChild(itemControls);
                    cartItems.appendChild(cartItem);
                });
            }

            // Re-initialize PayPal button when cart changes
            initPayPalCheckout();
        }

        async function initPayPalCheckout() {
            const container = document.getElementById('paypal-checkout-container');
            
            if (cart.length === 0) {
                while (container.firstChild) {
                    container.removeChild(container.firstChild);
                }
                return;
            }

            // Add shipping to items for PayPal
            const shippingItem = {
                name: 'Shipping',
                unit_amount: {
                    currency_code: 'USD',
                    value: shippingCost.toFixed(2)
                },
                quantity: 1
            };

            while (container.firstChild) {
                container.removeChild(container.firstChild);
            }

            paypal.Buttons({
                createOrder: function(data, actions) {
                    const items = cart.map(item => ({
                        name: item.name,
                        unit_amount: {
                            currency_code: 'USD',
                            value: item.price.toFixed(2)
                        },
                        quantity: item.quantity
                    }));

                    // Add shipping as a separate item
                    items.push(shippingItem);

                    const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);

                    return actions.order.create({
                        purchase_units: [{
                            amount: {
                                currency_code: 'USD',
                                value: cartTotal.toFixed(2),
                                breakdown: {
                                    item_total: {
                                        currency_code: 'USD',
                                        value: (subtotal + shippingCost).toFixed(2)
                                    }
                                }
                            },
                            items: items
                        }]
                    });
                },
                onApprove: async function(data, actions) {
                    try {
                        const details = await actions.order.capture();
                        
                        // Get customer info from PayPal response
                        const customerName = `${details.payer.name.given_name} ${details.payer.name.surname || ''}`.trim();
                        const customerEmail = details.payer.email_address;
                        
                        // Create and complete order in our backend
                        const response = await fetch('/api/orders/process-payment', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                items: cart,
                                customerName,
                                customerEmail,
                                paypalOrderId: data.orderID,
                                paypalDetails: details,
                                shippingCost: shippingCost
                            })
                        });

                        if (!response.ok) {
                            const errorData = await response.json();
                            throw new Error(errorData.error || 'Failed to process order');
                        }

                        const result = await response.json();

                        alert(`Thank you for your purchase, ${details.payer.name.given_name}! You'll receive an email confirmation shortly.`);
                        cart = [];
                        updateCartDisplay();
                        updateCartTotal();
                        document.getElementById('cart-sidebar').classList.remove('active');
                        
                    } catch (error) {
                        console.error('Payment processing error:', error);
                        alert('There was an error processing your payment. Please contact support. ' + error.message);
                    }
                },
                onError: function(err) {
                    console.error('PayPal error:', err);
                    alert('Payment failed. Please try again.');
                }
            }).render(container);
        }
    </script>
</body>
</html>